<!-- User Note: TFBR1A2ME3NGNDA. Use This Template for Bank Reconciliations using both Summary & Detail Reporting -->
<!-- User Note: The Template will work for All Data Ranges - all Data Ranges must be of type Detail, except for DR01 which must be of Type Summary -->
<!-- User Note: The Template Is Designed To Display Different Levels of Data Depending on the Data Range -->
<!-- User Note: Only Data Range Totals are displayed for DR01 (no line values, subtotals or Row Totals displayed for this Data Range) -->
<!-- User Note: Line Values, Subtotals, Row Totals and Data Range Totals are displayed for All Detail Data Ranges -->
<!-- User Note: The Template expects labels L01, L02, L03, L04 and L05 for the Data Range Total Calcs in DR01, DR02, DR03, DR04 and DR05 respectively, L06 for any other Data Range Total Calcs and L10 for the Grand Total based on All Data Ranges -->
<!-- User Note: All Data Ranges display all values as Normal, so credits are negative and debits are positive (2 Decimal places) -->
<!-- User Note: This Template Includes a Calculation based on totals for all Data Ranges: Data Range Grand Total = Data Range 01 Total - Data Range 02 Total + âˆ‘(Data Range Total from DR03 onwards) -->
<!-- REGION 01: GENERAL CONFIGURATION START-->
<!-- User Note: I Want To Use The Reporting Engine To Generate Reports -->
<apex:page standardController="ffr__ReportingDefinition__c" extensions="ffr.ReportingTemplateController" readOnly="true" showHeader="true" sidebar="false" standardStylesheets="false" renderas="{!RenderReportAs}" contenttype="{!SaveReportAS}">
<!-- User Note: I Want To Have A Single Format For All Of My Reports So That I Can Style The Fonts And Colors -->
<!-- User Note: A Standard Stylesheet Has Been Provided In The Static Resources -->
<!-- User Note: You Can Create Your Own Stylesheet In The Static Resources And Apply It To Your Reports -->
<!-- User Note: The Style Has Been Designed To Allow Variations Within Different Types Of Reports -->
<!-- User Note: A Summary Report Hides The Lowest Level Of Rows But Retains Calculations -->
    <apex:stylesheet value="{!URLFOR($Resource.ffr__ReportingDefaultStyles, 'ReportingDefaultStyles.css')}"/>
    <apex:stylesheet value="{!StyleSheetName}"/>
<!-- Variable to represent boolean true/false when needing to set other variables to these states -->
    <apex:variable var="true" value="{!1=1}"/>
    <apex:variable var="false" value="{!1=0}"/>
    <apex:variable var="displayheader" value="{!true}"/>


    <apex:variable var="GLA1Name" value="GLA1"/>
    <apex:variable var="GLA2Name" value="GLA2"/>
    <apex:variable var="GLA3Name" value="GLA3"/>
    <apex:variable var="GLA4Name" value="GLA4"/>
    <apex:variable var="GLA5Name" value="GLA5"/>
    <apex:variable var="GLA6Name" value="GLA6"/>
    <apex:variable var="GLA7Name" value="GLA7"/>
    <apex:variable var="GLA1Value" value="{!100}"/>
    <apex:variable var="GLA2Value" value="{!100}"/>
    <apex:variable var="GLA3Value" value="{!100}"/>
    <apex:variable var="GLA4Value" value="{!100}"/>
    <apex:variable var="GLA5Value" value="{!100}"/>
    <apex:variable var="GLA6Value" value="{!100}"/>
    <apex:variable var="GLA7Value" value="{!100}"/>
<!-- User Note: I Want To Format Values On A Report In Different Ways -->
<!-- User Note: A Number Formatter Component Has Been Provided To Support Different Formats -->
<!-- User Note: The Coding Structure For The Variable Is As Follows Value/Percent Numberofdecimals Normal/Reversed Brackets/Minus 3CharacterInternationalCurrencyCode/None-->
<!-- User Note: Good Practice Is To Reverse Values Using A Format Rather Than Create Calculations On The Visualforce Page So Running Totals Can Be Easily Maintained-->
<!-- User Note: You Can Add Your Own Formats To The List Below. Try To Keep A Good Coding Structure-->
    <apex:variable var="dateFormat" value="{0, date, MM/dd/yyyy}"/>
    <apex:variable var="V2NCB" value="{0, number, #,###,###,##0.00;(#,###,###,##0.00)}"/>
    <apex:variable var="P2NCB" value="{0, number, #,###,###,##0.00%;(#,###,###,##0.00%)}"/>
    <apex:variable var="V0NCB" value="{0, number, #,###,###,##0;(#,###,###,##0)}"/>
    <apex:variable var="P0NCB" value="{0, number, #,###,###,##0%;(#,###,###,##0%)}"/>
    <apex:variable var="V2RCB" value="{0, number, (#,###,###,##0.00);#,###,###,##0.00}"/>
    <apex:variable var="P2RCB" value="{0, number, (#,###,###,##0.00%);#,###,###,##0.00%}"/>
    <apex:variable var="V0RCB" value="{0, number, (#,###,###,##0);#,###,###,##0}"/>
    <apex:variable var="P0RCB" value="{0, number, (#,###,###,##0%);#,###,###,##0%}"/>
    <apex:variable var="V2NCBUSD" value="{0, number, $#,###,###,##0.00;$(#,###,###,##0.00)}"/>
    <apex:variable var="V2RCBUSD" value="{0, number, $(#,###,###,##0.00);$#,###,###,##0.00}"/>
    <apex:variable var="V2ZCB" value="0.00"/>
    <apex:variable var="P2ZCB" value="0.00%"/>
    <apex:variable var="V2ZCBUSD" value="$0.00"/>
    <apex:variable var="V0ZCB" value="0"/>
    <apex:variable var="P0ZCB" value="0%"/>
    <apex:variable var="V0ZCBUSD" value="$0"/>
<!-- User Note: I Want To Change All Of The Value Formats Quickly Across The Whole Of The Report -->
<!-- User Note: Having The Variables Above Assigned To A Second Variable Here Means That Just Changing This Field Will -->
<!-- User Note: Apply The Results To All The Fields Where It Is Used -->
<!-- User Note: It Is Possible To Use Individual Variables Against A Line. This Method Allows You To Make A Single Change To All Related Formats  -->
<!-- User Note: Create a variable to control the format of numbers for Reporting Values of type Group (Summary and Detail Reporting) -->
    <apex:variable var="VG" value="{!V0NCB}"/>
    <apex:variable var="VGZ" value="{!V0ZCB}"/>
<!-- User Note: Create a variable to control the format of numbers for Reporting Values of type SUM (Summary Reporting) and All Reporting Values for Detail Reporting  -->
    <apex:variable var="VN" value="{!V2NCB}"/>
    <apex:variable var="PN" value="{!P2NCB}"/>
    <apex:variable var="VR" value="{!V2RCB}"/>
    <apex:variable var="PR" value="{!P2RCB}"/>
<!-- User Note: Create a variable to control the format of zeros for all Reporting Values (Summary Reporting (type Group and SUM) and Detail Reporting)  -->
    <apex:variable var="VZ" value="{!V2ZCB}"/>
    <apex:variable var="PZ" value="{!P2ZCB}"/>
<!-- REGION 01: GENERAL CONFIGURATION START-->
<!-- REGION 02: REPORT HEADER START -->
<!-- Demand The Report Definition Fields To Be Loaded Even If Data Is Not Found -->
    <apex:outputText value="{!ffr__ReportingDefinition__c.Name}" rendered="false"/>
    <apex:outputText value="{!ffr__ReportingDefinition__c.ffr__Description__c}" rendered="false"/>
    <apex:outputText value="{!ffr__ReportingDefinition__c.ffr__Title__c}" rendered="false"/>
    <apex:outputText value="{!ffr__ReportingDefinition__c.ffr__DisplayPrompts__c}" rendered="false"/>
    <apex:outputText value="{!ffr__ReportingDefinition__c.ffr__ReportingTemplate__c}" rendered="false"/>
    <apex:outputText value="{!ffr__ReportingDefinition__c.ffr__StyleSheet__c}" rendered="false"/>
    <apex:outputText value="{!ffr__ReportingDefinition__c.ffr__PrintStyleSheet__c}" rendered="false"/>
    <apex:outputText value="{!ffr__ReportingDefinition__c.ffr__CompanyLogo__c}" rendered="false"/>
    <apex:outputText value="{!ffr__ReportingDefinition__c.ffr__PrintChatterFeed__c}" rendered="false"/>
<!-- User Note: Show The Error Messages From The Reporting Engine -->
<apex:PageMessages />
    <div class="chatterPosition"></div>
<!-- User Note: I Want A Consistent Header Format To All Of My Reports With Titles Descriptions And Runtime Prompts Etc -->
<!-- User Note: When Creating New Templates, This Well Formatted Header Should Be Copied And Used Across All The Reports -->
    <table class="ffrgridd">
        <tr>
            <td><apex:image url="{!URLFOR(StaticResourceImages, CompanyLogo)}" rendered="{!DisplayCompanyLogo}" styleClass="logoReport"/></td>
        </tr>
        <tr>
            <td><h1 class="ffrtitle">{!ffr__ReportingDefinition__c.ffr__Title__c}</h1></td>
            <td align="right">{!NOW()}</td>
        </tr>
        <tr><td class="ffrgridspacer2"></td></tr>
        <tr>
            <td><h1 class="ffrname">{!ffr__ReportingDefinition__c.Name}</h1></td>
            <td align="right"><h2 class="ffrwhiteonwhite">{!ffr__ReportingDefinition__c.ffr__ReportingTemplate__c}</h2></td>
        </tr>
        <tr><td class="ffrgridspacer2"></td></tr>
        <tr>
            <td align="left"><apex:outputField value="{!ffr__ReportingDefinition__c.ffr__Description__c}"/></td>
            <td align="right"><h2 class="ffrwhiteonwhite">{!ffr__ReportingDefinition__c.ffr__StyleSheet__c}</h2></td>
        </tr>
    </table>
<!-- User Note: Create a new table to display the prompt information -->
    <table class="ffrgridnotfullpage">
        <tr><td class="ffrgridspacer2"></td></tr>
        <tr>
            <td align="left">
                <table class="ffrgrid">
                    <apex:repeat value="{!promptList}" var="prompt" >
                        <tr>
                            <td align="left">{!prompt.label}</td>
                            <td align="left" class="ffrgridspacer"></td>
                            <td align="left"><strong>{!prompt.value}</strong></td>
                        </tr>
                    </apex:repeat>
                </table>
            </td>
        </tr>
    </table>
<!-- User Note: Insert a space after the header -->
    <table class="ffrgrid">
        <tr><td class="ffrgridspacer"></td></tr>
    </table>
<!-- REGION 02: REPORT HEADER END -->
<!-- REGION 03: REPORT BODY-->
<!-- Initialize Grand Totals for All Data Ranges variable -->
<!-- This variable will be used to calculate the Bank Statement Balance, based on all 3 Data Ranges Total -->
<!-- It's calculated in stages, accumulating Data Ranges totals at the end of each Data Range Section to get to the following calculation -->
<!-- Data Range Grand Total = Data Range 01 Total - Data Range 02 Total + âˆ‘(Data Range Total from DR03 onwards) -->
    <apex:outputpanel rendered="{!!hasMessages}">
        <apex:variable value="{!0}" var="allDataRangesFirstTotal"/>
        <apex:variable value="{!0}" var="allDataRangesSecondTotal"/>
        <apex:variable value="{!0}" var="allDataRangesThirdTotal"/>
        <apex:variable value="{!0}" var="allDataRangesFourthTotal"/>
        <apex:variable value="{!0}" var="allDataRangesFifthTotal"/>

    <!-- DATA RANGE 1: START-->
        <apex:variable value="{!reportingDataKeyList}" var="reportingDataKey"/>
        <apex:variable var="dataRange" value="{!reportingData['DR01']}"/>
        <apex:outputpanel rendered="{!dataRange.TypeName == SummaryType}">

    <!-- User Note: Create a table to display Data Range 1 data -->
            <table class="ffrgrid">
    <!-- Column headings: only Filter Column Headings are displayed (no Reporting Values Group Headings) -->
    <!-- To ensure Headings are aligned with Line Data, we need to span the Group Labels -->

    <!-- Iterate over the Rows -->
                <apex:repeat value="{!dataRange.rowList}" var="row" >
    <!-- Setup for start of row -->
                    <apex:variable var="rowKeyNum" value="{!VALUE(row.key)}"/>
    <!-- Iterate over the Lines -->
                    <apex:repeat value="{!row.lineList}" var="line" >
    <!-- Line setup -->
    <!-- Each column is configured independently within an outputPanel the outputpanel rendered property determines whether the column is configured -->
    <!-- This uses the column render state variable (e.g. "renderColumnA" determines whether the panel for column A is configured and rendered) -->
                        <apex:variable value="{!0}" var="lineTotal"/>
                        <apex:variable var="assignGLA" value="{!true}"/>
    <!-- For each column, add the column value to the line total (column-row totals are updated separately) -->
                        <apex:outputPanel layout="none" rendered="{!assignGLA && GLA1Name == 'GLA1'}">
                            <apex:variable value="{!line.groups['01']}" var="GLA1Name"/>
                            <apex:variable value="{!line.columns['A'].values['A']}" var="GLA1Value"/>
                            <apex:variable var="assignGLA" value="{!false}"/>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!assignGLA && GLA2Name == 'GLA2'}">
                            <apex:variable value="{!line.groups['01']}" var="GLA2Name"/>
                            <apex:variable value="{!line.columns['A'].values['A']}" var="GLA2Value"/>
                            <apex:variable var="assignGLA" value="{!false}"/>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!assignGLA && GLA1Name == 'GLA3'}">
                            <apex:variable value="{!line.groups['01']}" var="GLA3Name"/>
                            <apex:variable value="{!line.columns['A'].values['A']}" var="GLA3Value"/>
                            <apex:variable var="assignGLA" value="{!false}"/>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!assignGLA && GLA4Name == 'GLA4'}">
                            <apex:variable value="{!line.groups['01']}" var="GLA4Name"/>
                            <apex:variable value="{!line.columns['A'].values['A']}" var="GLA4Value"/>
                            <apex:variable var="assignGLA" value="{!false}"/>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!assignGLA && GLA5Name == 'GLA5'}">
                            <apex:variable value="{!line.groups['01']}" var="GLA5Name"/>
                            <apex:variable value="{!line.columns['A'].values['A']}" var="GLA5Value"/>
                            <apex:variable var="assignGLA" value="{!false}"/>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!assignGLA && GLA6Name == 'GLA6'}">
                            <apex:variable value="{!line.groups['01']}" var="GLA6Name"/>
                            <apex:variable value="{!line.columns['A'].values['A']}" var="GLA6Value"/>
                            <apex:variable var="assignGLA" value="{!false}"/>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!assignGLA && GLA7Name == 'GLA7'}">
                            <apex:variable value="{!line.groups['01']}" var="GLA7Name"/>
                            <apex:variable value="{!line.columns['A'].values['A']}" var="GLA7Value"/>
                            <apex:variable var="assignGLA" value="{!false}"/>
                        </apex:outputPanel>
    <!-- Next line -->
                    </apex:repeat>

    <!-- Add the row-total to the grand-total so that the grand-total accumulates across all the rows -->
    <!-- Add up the values for the row total columns -->
    <!-- Note that the row-totals are reset for each successive row -->
                </apex:repeat>

            </table>
        </apex:outputpanel>
    <!-- DATA RANGE 01: END -->

    <!-- DETAIL DATA RANGES: START-->
    <!-- User Note: Initialize all Data Ranges of type "Detail" -->
        <apex:repeat value="{!reportingDataKeyList}" var="reportingDataKey">
            <apex:variable var="dataRange" value="{!reportingData[reportingDataKey]}"/>
            <apex:outputpanel rendered="{!dataRange.TypeName == DetailType}">
    <!-- User Note: These variables control whether a Reporting Value is being used by the Report Definition or not -->
                <apex:variable var="RenderReportingValue01" value="{!false}"/>
                <apex:variable var="RenderReportingValue02" value="{!false}"/>
                <apex:variable var="RenderReportingValue03" value="{!false}"/>
                <apex:variable var="RenderReportingValue04" value="{!false}"/>
                <apex:variable var="RenderReportingValue05" value="{!false}"/>
                <apex:variable var="RenderReportingValue06" value="{!false}"/>
                <apex:variable var="RenderReportingValue07" value="{!false}"/>
                <apex:variable var="RenderReportingValue08" value="{!false}"/>
                <apex:variable var="RenderReportingValue09" value="{!false}"/>
                <apex:variable var="RenderReportingValue10" value="{!false}"/>
                <apex:variable var="RenderReportingValue11" value="{!false}"/>
                <apex:variable var="RenderReportingValue12" value="{!false}"/>
                <apex:variable var="RenderReportingValue13" value="{!false}"/>
                <apex:variable var="RenderReportingValue14" value="{!false}"/>
                <apex:variable var="RenderReportingValue15" value="{!false}"/>
                <apex:variable var="RenderReportingValue16" value="{!false}"/>
                <apex:variable var="RenderReportingValue17" value="{!false}"/>
                <apex:variable var="RenderReportingValue18" value="{!false}"/>
                <apex:variable var="RenderReportingValue19" value="{!false}"/>
                <apex:variable var="RenderReportingValue20" value="{!false}"/>
                <apex:variable var="RenderReportingValue21" value="{!false}"/>
                <apex:variable var="RenderReportingValue22" value="{!false}"/>
                <apex:variable var="RenderReportingValue23" value="{!false}"/>
                <apex:variable var="RenderReportingValue24" value="{!false}"/>
                <apex:variable var="RenderReportingValue25" value="{!false}"/>
                <apex:variable var="displaySubtotals" value="{!false}"/>
    <!-- Now set the Reporting Value rendering state variables according to which Reporting Values have been used -->
                <apex:repeat var="reportingValue" value="{!dataRange.reportingValueList}">
                    <apex:variable var="displaySubtotals" value="{!true}" rendered="{!reportingValue.isSum}"/>
                    <apex:variable var="RenderReportingValue01" value="{!true}" rendered="{!reportingValue.key=='01'}" />
                    <apex:variable var="RenderReportingValue02" value="{!true}" rendered="{!reportingValue.key=='02'}" />
                    <apex:variable var="RenderReportingValue03" value="{!true}" rendered="{!reportingValue.key=='03'}" />
                    <apex:variable var="RenderReportingValue04" value="{!true}" rendered="{!reportingValue.key=='04'}" />
                    <apex:variable var="RenderReportingValue05" value="{!true}" rendered="{!reportingValue.key=='05'}" />
                    <apex:variable var="RenderReportingValue06" value="{!true}" rendered="{!reportingValue.key=='06'}" />
                    <apex:variable var="RenderReportingValue07" value="{!true}" rendered="{!reportingValue.key=='07'}" />
                    <apex:variable var="RenderReportingValue08" value="{!true}" rendered="{!reportingValue.key=='08'}" />
                    <apex:variable var="RenderReportingValue09" value="{!true}" rendered="{!reportingValue.key=='09'}" />
                    <apex:variable var="RenderReportingValue10" value="{!true}" rendered="{!reportingValue.key=='10'}" />
                    <apex:variable var="RenderReportingValue11" value="{!true}" rendered="{!reportingValue.key=='11'}" />
                    <apex:variable var="RenderReportingValue12" value="{!true}" rendered="{!reportingValue.key=='12'}" />
                    <apex:variable var="RenderReportingValue13" value="{!true}" rendered="{!reportingValue.key=='13'}" />
                    <apex:variable var="RenderReportingValue14" value="{!true}" rendered="{!reportingValue.key=='14'}" />
                    <apex:variable var="RenderReportingValue15" value="{!true}" rendered="{!reportingValue.key=='15'}" />
                    <apex:variable var="RenderReportingValue16" value="{!true}" rendered="{!reportingValue.key=='16'}" />
                    <apex:variable var="RenderReportingValue17" value="{!true}" rendered="{!reportingValue.key=='17'}" />
                    <apex:variable var="RenderReportingValue18" value="{!true}" rendered="{!reportingValue.key=='18'}" />
                    <apex:variable var="RenderReportingValue19" value="{!true}" rendered="{!reportingValue.key=='19'}" />
                    <apex:variable var="RenderReportingValue20" value="{!true}" rendered="{!reportingValue.key=='20'}" />
                    <apex:variable var="RenderReportingValue21" value="{!true}" rendered="{!reportingValue.key=='21'}" />
                    <apex:variable var="RenderReportingValue22" value="{!true}" rendered="{!reportingValue.key=='22'}" />
                    <apex:variable var="RenderReportingValue23" value="{!true}" rendered="{!reportingValue.key=='23'}" />
                    <apex:variable var="RenderReportingValue24" value="{!true}" rendered="{!reportingValue.key=='24'}" />
                    <apex:variable var="RenderReportingValue25" value="{!true}" rendered="{!reportingValue.key=='25'}" />
                </apex:repeat>

    <!-- Grand Totals for Data Range -->
                <apex:variable value="{!0}" var="grandTotalReportingValue21" rendered="{!RenderReportingValue21}"/>
                <apex:variable value="{!0}" var="grandTotalReportingValue22" rendered="{!RenderReportingValue21}"/>
                <apex:variable value="{!0}" var="grandTotalReportingValue23" rendered="{!RenderReportingValue21}"/>
                <apex:variable value="{!0}" var="grandTotalReportingValue24" rendered="{!RenderReportingValue24}"/>
                <apex:variable value="{!0}" var="grandTotalReportingValue25" rendered="{!RenderReportingValue25}"/>

    <!-- User Note: Insert a space between Data Ranges -->
                <table class="ffrgrid">
                    <tr><td class="ffrgridspacer"></td></tr>
                    <tr><td class="ffrgridspacer"></td></tr>
                </table>

    <!-- User Note: Display Detail Data Ranges' Label -->
                <h2 class="ffrtitle">{!reportingDataRanges[reportingDataKey].Name}</h2>
                <table class="ffrgrid">
                    <th class="ffrgridspacer"></th>
                </table>
    <!-- Create a table to show each Data Range data -->
                <table class="ffrgrid">
                    <apex:repeat value="{!dataRange.rowList}" var="row" >
                    <apex:variable value="{!NULLVALUE(row.Count,0) > 0}" var="notEmptyRow" />

    <!-- Define variables for the Row Totals -->
                        <apex:variable value="{!0}" var="rowTotalReportingValue21" rendered="{!RenderReportingValue21}"/>
                        <apex:variable value="{!0}" var="rowTotalReportingValue22" rendered="{!RenderReportingValue22}"/>
                        <apex:variable value="{!0}" var="rowTotalReportingValue23" rendered="{!RenderReportingValue23}"/>
                        <apex:variable value="{!0}" var="rowTotalReportingValue24" rendered="{!RenderReportingValue24}"/>
                        <apex:variable value="{!0}" var="rowTotalReportingValue25" rendered="{!RenderReportingValue25}"/>

    <!-- Reporting Value Headings: only displayed for Reporting Values 04 onwards (non-group Reporting Values) -->
                        <tr>
                            <apex:variable value="{!dataRange.reportingValueList}" var="reportingValue" />
                            <th class="{!IF(RenderReportingValue04,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['04'].label}" rendered="{!RenderReportingValue04}" /></th>
                            <th class="{!IF(RenderReportingValue05,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['05'].label}" rendered="{!RenderReportingValue05}" /></th>
                            <th class="{!IF(RenderReportingValue06,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['06'].label}" rendered="{!RenderReportingValue06}" /></th>
                            <th class="{!IF(RenderReportingValue07,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['07'].label}" rendered="{!RenderReportingValue07}" /></th>
                            <th class="{!IF(RenderReportingValue08,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['08'].label}" rendered="{!RenderReportingValue08}" /></th>
                            <th class="{!IF(RenderReportingValue09,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['09'].label}" rendered="{!RenderReportingValue09}" /></th>
                            <th class="{!IF(RenderReportingValue10,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['10'].label}" rendered="{!RenderReportingValue10}" /></th>
                            <th class="{!IF(RenderReportingValue11,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['11'].label}" rendered="{!RenderReportingValue11}" /></th>
                            <th class="{!IF(RenderReportingValue12,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['12'].label}" rendered="{!RenderReportingValue12}" /></th>
                            <th class="{!IF(RenderReportingValue13,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['13'].label}" rendered="{!RenderReportingValue13}" /></th>
                            <th class="{!IF(RenderReportingValue14,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['14'].label}" rendered="{!RenderReportingValue14}" /></th>
                            <th class="{!IF(RenderReportingValue15,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['15'].label}" rendered="{!RenderReportingValue15}" /></th>
                            <th class="{!IF(RenderReportingValue16,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['16'].label}" rendered="{!RenderReportingValue16}" /></th>
                            <th class="{!IF(RenderReportingValue17,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['17'].label}" rendered="{!RenderReportingValue17}" /></th>
                            <th class="{!IF(RenderReportingValue18,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['18'].label}" rendered="{!RenderReportingValue18}" /></th>
                            <th class="{!IF(RenderReportingValue19,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['19'].label}" rendered="{!RenderReportingValue19}" /></th>
                            <th class="{!IF(RenderReportingValue20,'ffrgridtitleleftd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['20'].label}" rendered="{!RenderReportingValue20}" /></th>
                            <th class="{!IF(RenderReportingValue21,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="Debits" rendered="{!RenderReportingValue21}" /></th>
                            <th class="{!IF(RenderReportingValue21,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="Credits" rendered="{!RenderReportingValue21}" /></th>
                            <th class="{!IF(RenderReportingValue21,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="Balance" rendered="{!RenderReportingValue21}" /></th>
                            <th class="{!IF(RenderReportingValue24,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['24'].label}" rendered="{!RenderReportingValue24}" /></th>
                            <th class="{!IF(RenderReportingValue25,'ffrgridtitlerightd','ffrhidden')}"><apex:outputText value="{!dataRange.reportingValues['25'].label}" rendered="{!RenderReportingValue25}" /></th>
                        </tr>

    <!-- Initialize variables with any value, as long as it is the same type as Reporting Value type and the row is not empty-->
                    <apex:variable var="previousLineReportingValue01" value="{!row.lines['0'].Values['01']}" rendered="{!RenderReportingValue01 && notEmptyRow}"/>
                    <apex:variable var="previousLineReportingValue02" value="{!row.lines['0'].Values['02']}" rendered="{!RenderReportingValue02 && notEmptyRow}"/>
                    <apex:variable var="previousLineReportingValue03" value="{!row.lines['0'].Values['03']}" rendered="{!RenderReportingValue03 && notEmptyRow}"/>
                    <apex:variable var="currentLineReportingValue01" value="{!row.lines['0'].Values['01']}" rendered="{!RenderReportingValue01 && notEmptyRow}"/>
                    <apex:variable var="currentLineReportingValue02" value="{!row.lines['0'].Values['02']}" rendered="{!RenderReportingValue02 && notEmptyRow}"/>
                    <apex:variable var="currentLineReportingValue03" value="{!row.lines['0'].Values['03']}" rendered="{!RenderReportingValue03 && notEmptyRow}"/>

                        <apex:variable value="{!0}" var="subtotalGroup2ReportingValue21" rendered="{!RenderReportingValue21}"/>
                        <apex:variable value="{!0}" var="subtotalGroup2ReportingValue22" rendered="{!RenderReportingValue21}"/>
                        <apex:variable value="{!0}" var="subtotalGroup2ReportingValue23" rendered="{!RenderReportingValue21}"/>
                        <apex:variable value="{!0}" var="subtotalGroup2ReportingValue24" rendered="{!RenderReportingValue24}"/>
                        <apex:variable value="{!0}" var="subtotalGroup2ReportingValue25" rendered="{!RenderReportingValue25}"/>

    <!-- This variable is used to determine whether the line is the first line in the row - to prevent a subtotal being printed before the first line -->

                        <apex:variable var="firstLine" value="{!true}"/>
    <!-- User Note: The Following Variables Control Whether A Subtotal Line Should Be Rendered -->
                        <apex:variable var="doSubtotal01" value="{!false}"/>
                        <apex:variable var="doSubtotal02" value="{!false}"/>
                        <apex:variable var="doSubtotal03" value="{!false}"/>

                        <apex:repeat value="{!row.lineList}" var="line" >
                            <apex:variable var="currentLineReportingValue01" value="{!line.Values['01']}" rendered="{!RenderReportingValue01 && dataRange.reportingValues['01'].isGroup}"/>
                            <apex:variable var="currentLineReportingValue02" value="{!line.Values['02']}" rendered="{!RenderReportingValue02 && dataRange.reportingValues['02'].isGroup}"/>
                            <apex:variable var="currentLineReportingValue03" value="{!line.Values['03']}" rendered="{!RenderReportingValue03 && dataRange.reportingValues['03'].isGroup}"/>

                            <apex:variable var="doSubtotal01" value="{!(currentLineReportingValue01!=previousLineReportingValue01) && dataRange.reportingValues['01'].isGroup}" rendered="{!RenderReportingValue01}"/>
                            <apex:variable var="doSubtotal02" value="{!(currentLineReportingValue02!=previousLineReportingValue02) && dataRange.reportingValues['02'].isGroup}" rendered="{!RenderReportingValue02}"/>
                            <apex:variable var="doSubtotal03" value="{!(currentLineReportingValue03!=previousLineReportingValue03) && dataRange.reportingValues['03'].isGroup}" rendered="{!RenderReportingValue03}"/>

    <!-- Process Group 2 subtotal line -->
                        <apex:variable var="createSubtotalLine" value="{!(!firstLine) && RenderReportingValue02 && (doSubtotal02 || doSubtotal01) && displaySubtotals && notEmptyRow}"/>
                            <tr>
                                <td class="{!if(createSubtotalLine && RenderReportingValue02,'ffrsubtotallabeld','ffrsubtotalhidden')}" colspan="17">
                                    <span class="{!if(createSubtotalLine && RenderReportingValue02 && dataRange.reportingValues['02'].isGroup,'ffrsubtotallabeld','ffrsubtotalhidden')}"><ffr:Formatter value="{!previousLineReportingValue02}" type="{!IF(previousLineReportingValue02 == 0, TypeZero, dataRange.reportingValues['02'].Type)}" rendered="{!RenderReportingValue02}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/></span>
                                </td>
                                <td class="{!if(createSubtotalLine && RenderReportingValue21,'ffrsubtotald','ffrsubtotalhidden')}">
                                    <span class="{!if(createSubtotalLine && RenderReportingValue21 && dataRange.reportingValues['21'].isSum,'ffrsubtotald','ffrsubtotalhidden')}"><ffr:Formatter value="{!subtotalGroup2ReportingValue21}" type="{!IF(subtotalGroup2ReportingValue21 == 0, TypeZero, dataRange.reportingValues['21'].Type)}" rendered="{!RenderReportingValue21}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/></span>
                                </td>
                                <td class="{!if(createSubtotalLine && RenderReportingValue21,'ffrsubtotald','ffrsubtotalhidden')}">
                                    <span class="{!if(createSubtotalLine && RenderReportingValue21 && dataRange.reportingValues['21'].isSum,'ffrsubtotald','ffrsubtotalhidden')}"><ffr:Formatter value="{!subtotalGroup2ReportingValue22}" type="{!IF(subtotalGroup2ReportingValue22 == 0, TypeZero, dataRange.reportingValues['21'].Type)}" rendered="{!RenderReportingValue21}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/></span>
                                </td>
                                <td class="{!if(createSubtotalLine && RenderReportingValue21,'ffrsubtotald','ffrsubtotalhidden')}">
                                    <span class="{!if(createSubtotalLine && RenderReportingValue21 && dataRange.reportingValues['21'].isSum,'ffrsubtotald','ffrsubtotalhidden')}"><ffr:Formatter value="{!IF(GLA1Name == previousLineReportingValue02,GLA1Value,IF(GLA2Name == previousLineReportingValue02,GLA2Value,IF(GLA3Name == previousLineReportingValue02,GLA3Value,IF(GLA4Name == previousLineReportingValue02,GLA4Value,IF(GLA5Name == previousLineReportingValue02,GLA5Value,IF(GLA6Name == previousLineReportingValue02,GLA6Value,IF(GLA7Name == previousLineReportingValue02,GLA7Value,subtotalGroup2ReportingValue23)))))))}" type="{!IF(subtotalGroup2ReportingValue23 == 0, TypeZero, dataRange.reportingValues['21'].Type)}" rendered="{!RenderReportingValue21}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/></span>
                                </td>
                                <td class="{!if(createSubtotalLine && RenderReportingValue24,'ffrsubtotald','ffrsubtotalhidden')}">
                                    <span class="{!if(createSubtotalLine && RenderReportingValue24 && dataRange.reportingValues['24'].isSum,'ffrsubtotald','ffrsubtotalhidden')}"><ffr:Formatter value="{!subtotalGroup2ReportingValue24}" type="{!IF(subtotalGroup2ReportingValue24 == 0, TypeZero, dataRange.reportingValues['24'].Type)}" rendered="{!RenderReportingValue24}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/></span>
                                </td>
                                <td class="{!if(createSubtotalLine && RenderReportingValue25,'ffrsubtotald','ffrsubtotalhidden')}"  >
                                    <span class="{!if(createSubtotalLine && RenderReportingValue25 && dataRange.reportingValues['25'].isSum,'ffrsubtotald','ffrsubtotalhidden')}"><ffr:Formatter value="{!subtotalGroup2ReportingValue25}" type="{!IF(subtotalGroup2ReportingValue25 == 0, TypeZero, dataRange.reportingValues['25'].Type)}" rendered="{!RenderReportingValue25}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/></span>
                                </td>
                            </tr>
    <!-- Reset the Subtotals for Group 2 -->
                            <apex:variable value="{!0}" var="subtotalGroup2ReportingValue21" rendered="{!RenderReportingValue21 && createSubtotalLine}"/>
                            <apex:variable value="{!0}" var="subtotalGroup2ReportingValue22" rendered="{!RenderReportingValue21 && createSubtotalLine}"/>
                            <apex:variable value="{!0}" var="subtotalGroup2ReportingValue23" rendered="{!RenderReportingValue21 && createSubtotalLine}"/>
                            <apex:variable value="{!0}" var="subtotalGroup2ReportingValue24" rendered="{!RenderReportingValue24 && createSubtotalLine}"/>
                            <apex:variable value="{!0}" var="subtotalGroup2ReportingValue25" rendered="{!RenderReportingValue25 && createSubtotalLine}"/>
                            <apex:variable var="displayheader" value="{!IF(createSubtotalLine,true,displayheader)}"/>


    <!-- Accumulate values for Subtotals, Row Totals and Data Range Totals -->
                            <tr>
                                <td class="ffrhidden">
                                    <apex:outputPanel rendered="{!RenderReportingValue21 && dataRange.reportingValues['21'].isSum && line.Values['21'] > 0}">
                                        <apex:variable value="{!subtotalGroup2ReportingValue21 + line.Values['21']}" var="subtotalGroup2ReportingValue21" />
                                        <apex:variable value="{!rowTotalReportingValue21 + line.Values['21']}" var="rowTotalReportingValue21" />
                                        <apex:variable value="{!grandTotalReportingValue21 + line.Values['21']}" var="grandTotalReportingValue21" />
                                    </apex:outputPanel>
                                    <apex:outputPanel rendered="{!RenderReportingValue21 && dataRange.reportingValues['21'].isSum && line.Values['21'] < 0}">
                                        <apex:variable value="{!subtotalGroup2ReportingValue22 + line.Values['21']}" var="subtotalGroup2ReportingValue22" />
                                        <apex:variable value="{!rowTotalReportingValue22 + line.Values['21']}" var="rowTotalReportingValue22" />
                                        <apex:variable value="{!grandTotalReportingValue22 + line.Values['21']}" var="grandTotalReportingValue22" />
                                    </apex:outputPanel>
                                    <apex:outputPanel rendered="{!RenderReportingValue21 && dataRange.reportingValues['21'].isSum}">
                                        <apex:variable value="{!subtotalGroup2ReportingValue23 + line.Values['21']}" var="subtotalGroup2ReportingValue23" />
                                        <apex:variable value="{!rowTotalReportingValue23 + line.Values['21']}" var="rowTotalReportingValue23" />
                                        <apex:variable value="{!grandTotalReportingValue23 + line.Values['21']}" var="grandTotalReportingValue23" />
                                    </apex:outputPanel>
                                    <apex:outputPanel rendered="{!RenderReportingValue24 && dataRange.reportingValues['24'].isSum}">
                                        <apex:variable value="{!subtotalGroup2ReportingValue24 + line.Values['24']}" var="subtotalGroup2ReportingValue24" />
                                        <apex:variable value="{!rowTotalReportingValue24 + line.Values['24']}" var="rowTotalReportingValue24" />
                                        <apex:variable value="{!grandTotalReportingValue24 + line.Values['24']}" var="grandTotalReportingValue24" />
                                    </apex:outputPanel>
                                    <apex:outputPanel rendered="{!RenderReportingValue25 && dataRange.reportingValues['25'].isSum}">
                                        <apex:variable value="{!subtotalGroup2ReportingValue25 + line.Values['25']}" var="subtotalGroup2ReportingValue25" />
                                        <apex:variable value="{!rowTotalReportingValue25 + line.Values['25']}" var="rowTotalReportingValue25" />
                                        <apex:variable value="{!grandTotalReportingValue25 + line.Values['25']}" var="grandTotalReportingValue25" />
                                    </apex:outputPanel>
                                </td>
                            </tr>
    <!-- Display line values: only displayed for Reporting Values 04 onwards (non-group Reporting Values) -->
                            <apex:variable value="{!dataRange.reportingValues['02']}" var="reportingValue02" rendered="{!true}"/>
                            <apex:variable value="{!dataRange.reportingValues['04']}" var="reportingValue04" rendered="{!RenderReportingValue04}"/>
                            <apex:variable value="{!dataRange.reportingValues['05']}" var="reportingValue05" rendered="{!RenderReportingValue05}"/>
                            <apex:variable value="{!dataRange.reportingValues['06']}" var="reportingValue06" rendered="{!RenderReportingValue06}"/>
                            <apex:variable value="{!dataRange.reportingValues['07']}" var="reportingValue07" rendered="{!RenderReportingValue07}"/>
                            <apex:variable value="{!dataRange.reportingValues['08']}" var="reportingValue08" rendered="{!RenderReportingValue08}"/>
                            <apex:variable value="{!dataRange.reportingValues['09']}" var="reportingValue09" rendered="{!RenderReportingValue09}"/>
                            <apex:variable value="{!dataRange.reportingValues['10']}" var="reportingValue10" rendered="{!RenderReportingValue10}"/>
                            <apex:variable value="{!dataRange.reportingValues['11']}" var="reportingValue11" rendered="{!RenderReportingValue11}"/>
                            <apex:variable value="{!dataRange.reportingValues['12']}" var="reportingValue12" rendered="{!RenderReportingValue12}"/>
                            <apex:variable value="{!dataRange.reportingValues['13']}" var="reportingValue13" rendered="{!RenderReportingValue13}"/>
                            <apex:variable value="{!dataRange.reportingValues['14']}" var="reportingValue14" rendered="{!RenderReportingValue14}"/>
                            <apex:variable value="{!dataRange.reportingValues['15']}" var="reportingValue15" rendered="{!RenderReportingValue15}"/>
                            <apex:variable value="{!dataRange.reportingValues['16']}" var="reportingValue16" rendered="{!RenderReportingValue16}"/>
                            <apex:variable value="{!dataRange.reportingValues['17']}" var="reportingValue17" rendered="{!RenderReportingValue17}"/>
                            <apex:variable value="{!dataRange.reportingValues['18']}" var="reportingValue18" rendered="{!RenderReportingValue18}"/>
                            <apex:variable value="{!dataRange.reportingValues['19']}" var="reportingValue19" rendered="{!RenderReportingValue19}"/>
                            <apex:variable value="{!dataRange.reportingValues['20']}" var="reportingValue20" rendered="{!RenderReportingValue20}"/>
                            <apex:variable value="{!dataRange.reportingValues['21']}" var="reportingValue21" rendered="{!RenderReportingValue21}"/>
                            <apex:variable value="{!dataRange.reportingValues['22']}" var="reportingValue22" rendered="{!RenderReportingValue22}"/>
                            <apex:variable value="{!dataRange.reportingValues['23']}" var="reportingValue23" rendered="{!RenderReportingValue23}"/>
                            <apex:variable value="{!dataRange.reportingValues['24']}" var="reportingValue24" rendered="{!RenderReportingValue24}"/>
                            <apex:variable value="{!dataRange.reportingValues['25']}" var="reportingValue25" rendered="{!RenderReportingValue25}"/>
                                <!-- display the title and sum -->
                            <tr>
                            <td class="{!if(displayheader,'ffrcalcsumlabeld','ffrsubtotalhidden')}" colspan="19">
                                <apex:outputPanel layout="none" rendered="{!displayheader}">{!line.Values[reportingValue02.key]}</apex:outputPanel>
                            </td>
                            <td class="{!if(displayheader,'ffrgridrowd','ffrsubtotalhidden')}">
                                <ffr:Formatter value="{!IF(GLA1Name == line.Values[reportingValue02.key],GLA1Value,IF(GLA2Name == line.Values[reportingValue02.key],GLA2Value,IF(GLA3Name == line.Values[reportingValue02.key],GLA3Value,IF(GLA4Name == line.Values[reportingValue02.key],GLA4Value,IF(GLA5Name == line.Values[reportingValue02.key],GLA5Value,IF(GLA6Name == line.Values[reportingValue02.key],GLA6Value,IF(GLA7Name == line.Values[reportingValue02.key],GLA7Value,0)))))))}" type="{!IF(line.Values[reportingValue21.key] == 0, TypeZero, reportingValue21.Type)}" rendered="{!displayheader}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/>
                                <apex:variable var="displayheader" value="{!false}"/>
                            </td>
                            </tr>

                            <tr>
                                <td class="{!IF(RenderReportingValue04,IF(reportingValue04.Type == TypeInteger || reportingValue04.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue04.key]}" type="{!IF(line.Values[reportingValue04.key] == 0, TypeZero, reportingValue04.Type)}" rendered="{!RenderReportingValue04}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue05,IF(reportingValue05.Type == TypeInteger || reportingValue05.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue05.key]}" type="{!IF(line.Values[reportingValue05.key] == 0, TypeZero, reportingValue05.Type)}" rendered="{!RenderReportingValue05}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue06,IF(reportingValue06.Type == TypeInteger || reportingValue06.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue06.key]}" type="{!IF(line.Values[reportingValue06.key] == 0, TypeZero, reportingValue06.Type)}" rendered="{!RenderReportingValue06}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue07,IF(reportingValue07.Type == TypeInteger || reportingValue07.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue07.key]}" type="{!IF(line.Values[reportingValue07.key] == 0, TypeZero, reportingValue07.Type)}" rendered="{!RenderReportingValue07}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue08,IF(reportingValue08.Type == TypeInteger || reportingValue08.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue08.key]}" type="{!IF(line.Values[reportingValue08.key] == 0, TypeZero, reportingValue08.Type)}" rendered="{!RenderReportingValue08}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue09,IF(reportingValue09.Type == TypeInteger || reportingValue09.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue09.key]}" type="{!IF(line.Values[reportingValue09.key] == 0, TypeZero, reportingValue09.Type)}" rendered="{!RenderReportingValue09}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue10,IF(reportingValue10.Type == TypeInteger || reportingValue10.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue10.key]}" type="{!IF(line.Values[reportingValue10.key] == 0, TypeZero, reportingValue10.Type)}" rendered="{!RenderReportingValue10}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue11,IF(reportingValue11.Type == TypeInteger || reportingValue11.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue11.key]}" type="{!IF(line.Values[reportingValue11.key] == 0, TypeZero, reportingValue11.Type)}" rendered="{!RenderReportingValue11}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue12,IF(reportingValue12.Type == TypeInteger || reportingValue12.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue12.key]}" type="{!IF(line.Values[reportingValue12.key] == 0, TypeZero, reportingValue12.Type)}" rendered="{!RenderReportingValue12}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue13,IF(reportingValue13.Type == TypeInteger || reportingValue13.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue13.key]}" type="{!IF(line.Values[reportingValue13.key] == 0, TypeZero, reportingValue13.Type)}" rendered="{!RenderReportingValue13}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue14,IF(reportingValue14.Type == TypeInteger || reportingValue14.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue14.key]}" type="{!IF(line.Values[reportingValue14.key] == 0, TypeZero, reportingValue14.Type)}" rendered="{!RenderReportingValue14}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue15,IF(reportingValue15.Type == TypeInteger || reportingValue15.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue15.key]}" type="{!IF(line.Values[reportingValue15.key] == 0, TypeZero, reportingValue15.Type)}" rendered="{!RenderReportingValue15}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue16,IF(reportingValue16.Type == TypeInteger || reportingValue16.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue16.key]}" type="{!IF(line.Values[reportingValue16.key] == 0, TypeZero, reportingValue16.Type)}" rendered="{!RenderReportingValue16}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue17,IF(reportingValue17.Type == TypeInteger || reportingValue17.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue17.key]}" type="{!IF(line.Values[reportingValue17.key] == 0, TypeZero, reportingValue17.Type)}" rendered="{!RenderReportingValue17}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue18,IF(reportingValue18.Type == TypeInteger || reportingValue18.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue18.key]}" type="{!IF(line.Values[reportingValue18.key] == 0, TypeZero, reportingValue18.Type)}" rendered="{!RenderReportingValue18}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue19,IF(reportingValue19.Type == TypeInteger || reportingValue19.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue19.key]}" type="{!IF(line.Values[reportingValue19.key] == 0, TypeZero, reportingValue19.Type)}" rendered="{!RenderReportingValue19}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue20,IF(reportingValue20.Type == TypeInteger || reportingValue20.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue20.key]}" type="{!IF(line.Values[reportingValue20.key] == 0, TypeZero, reportingValue20.Type)}" rendered="{!RenderReportingValue20}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue21,IF(reportingValue21.Type == TypeInteger || reportingValue21.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!IF(line.Values[reportingValue21.key]>0,line.Values[reportingValue21.key],0)}" type="{!IF(line.Values[reportingValue21.key] == 0, TypeZero, reportingValue21.Type)}" rendered="{!RenderReportingValue21}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue21,IF(reportingValue21.Type == TypeInteger || reportingValue21.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!IF(line.Values[reportingValue21.key]<0,line.Values[reportingValue21.key],0)}" type="{!IF(line.Values[reportingValue21.key] == 0, TypeZero, reportingValue21.Type)}" rendered="{!RenderReportingValue21}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <apex:variable var="GLA1Value" value="{!IF(GLA1Name == line.Values[reportingValue02.key],GLA1Value + line.Values[reportingValue21.key],GLA1Value)}"/>
                                <apex:variable var="GLA2Value" value="{!IF(GLA2Name == line.Values[reportingValue02.key],GLA2Value + line.Values[reportingValue21.key],GLA2Value)}"/>
                                <apex:variable var="GLA3Value" value="{!IF(GLA3Name == line.Values[reportingValue02.key],GLA3Value + line.Values[reportingValue21.key],GLA3Value)}"/>
                                <apex:variable var="GLA4Value" value="{!IF(GLA4Name == line.Values[reportingValue02.key],GLA4Value + line.Values[reportingValue21.key],GLA4Value)}"/>
                                <apex:variable var="GLA5Value" value="{!IF(GLA5Name == line.Values[reportingValue02.key],GLA5Value + line.Values[reportingValue21.key],GLA5Value)}"/>
                                <apex:variable var="GLA6Value" value="{!IF(GLA6Name == line.Values[reportingValue02.key],GLA6Value + line.Values[reportingValue21.key],GLA6Value)}"/>
                                <apex:variable var="GLA7Value" value="{!IF(GLA7Name == line.Values[reportingValue02.key],GLA7Value + line.Values[reportingValue21.key],GLA7Value)}"/>
                                <td class="{!IF(RenderReportingValue21,IF(reportingValue21.Type == TypeInteger || reportingValue21.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!IF(GLA1Name == line.Values[reportingValue02.key],GLA1Value,IF(GLA2Name == line.Values[reportingValue02.key],GLA2Value,IF(GLA3Name == line.Values[reportingValue02.key],GLA3Value,IF(GLA4Name == line.Values[reportingValue02.key],GLA4Value,IF(GLA5Name == line.Values[reportingValue02.key],GLA5Value,IF(GLA6Name == line.Values[reportingValue02.key],GLA6Value,IF(GLA7Name == line.Values[reportingValue02.key],GLA7Value,subtotalGroup2ReportingValue23)))))))}" type="{!IF(line.Values[reportingValue21.key] == 0, TypeZero, reportingValue21.Type)}" rendered="{!RenderReportingValue21}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue24,IF(reportingValue24.Type == TypeInteger || reportingValue24.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue24.key]}" type="{!IF(line.Values[reportingValue24.key] == 0, TypeZero, reportingValue24.Type)}" rendered="{!RenderReportingValue24}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/>
                                </td>
                                <td class="{!IF(RenderReportingValue25,IF(reportingValue25.Type == TypeInteger || reportingValue25.Type == TypeDouble,'ffrgridrowd','ffrgridrowlabeld'),'ffrhidden')}">
                                <ffr:Formatter value="{!line.Values[reportingValue25.key]}" type="{!IF(line.Values[reportingValue25.key] == 0, TypeZero, reportingValue25.Type)}" rendered="{!RenderReportingValue25}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/>
                                </td>
                            </tr>

    <!-- Set currentLine as previousLine -->
                            <apex:variable var="previousLineReportingValue01" value="{!currentLineReportingValue01}" rendered="{!RenderReportingValue01 && doSubtotal01}"/>
                            <apex:variable var="previousLineReportingValue02" value="{!currentLineReportingValue02}" rendered="{!RenderReportingValue02 && doSubtotal02}"/>
                            <apex:variable var="previousLineReportingValue03" value="{!currentLineReportingValue03}" rendered="{!RenderReportingValue03 && doSubtotal03}"/>

    <!-- If this was the first line, it was completed, so set first line to false -->
                            <apex:variable var="firstLine" value="{!false}" rendered="{!firstLine}"/>

    <!-- Next Line -->
                        </apex:repeat>

    <!-- Once finished all row lines, check whether a last subtotal line should be rendered -->
                        <apex:variable var="renderLastSubtotal" value="{!false}"/>

    <!-- Process an end of row subtotal line for Group 2 -->
                    <apex:variable var="renderLastSubtotal" value="{!IF(RenderReportingValue02 && dataRange.reportingValues['02'].isGroup && notEmptyRow,true,false)}"/>
                        <tr>
                            <td class="{!if(renderLastSubtotal && displaySubtotals && RenderReportingValue02,'ffrsubtotallabeld','ffrsubtotalhidden')}" colspan="17">
                                <span class="{!if(RenderReportingValue02 && dataRange.reportingValues['02'].isGroup,'ffrsubtotallabeld','ffrsubtotalhidden')}"><ffr:Formatter value="{!previousLineReportingValue02}" type="{!IF(previousLineReportingValue02 == 0, TypeZero, dataRange.reportingValues['02'].Type)}" rendered="{!RenderReportingValue02}" numberPattern="{!VG}" zeroPattern="{!VGZ}" datePattern="{!dateFormat}"/></span>
                            </td>
                            <td class="{!if(renderLastSubtotal && displaySubtotals && RenderReportingValue21,'ffrsubtotald','ffrsubtotalhidden')}">
                                <span class="{!if(RenderReportingValue21 && dataRange.reportingValues['21'].isSum,'ffrsubtotald','ffrsubtotalhidden')}"><ffr:Formatter value="{!subtotalGroup2ReportingValue21}" type="{!IF(subtotalGroup2ReportingValue21 == 0, TypeZero, dataRange.reportingValues['21'].Type)}" rendered="{!RenderReportingValue21}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/></span>
                            </td>
                            <td class="{!if(renderLastSubtotal && displaySubtotals && RenderReportingValue21,'ffrsubtotald','ffrsubtotalhidden')}">
                                <span class="{!if(RenderReportingValue21 && dataRange.reportingValues['21'].isSum,'ffrsubtotald','ffrsubtotalhidden')}"><ffr:Formatter value="{!subtotalGroup2ReportingValue22}" type="{!IF(subtotalGroup2ReportingValue22 == 0, TypeZero, dataRange.reportingValues['21'].Type)}" rendered="{!RenderReportingValue21}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/></span>
                            </td>
                            <td class="{!if(renderLastSubtotal && displaySubtotals && RenderReportingValue21,'ffrsubtotald','ffrsubtotalhidden')}">
                                <span class="{!if(RenderReportingValue21 && dataRange.reportingValues['21'].isSum,'ffrsubtotald','ffrsubtotalhidden')}"><ffr:Formatter value="{!IF(GLA1Name == previousLineReportingValue02,GLA1Value,IF(GLA2Name == previousLineReportingValue02,GLA2Value,IF(GLA3Name == previousLineReportingValue02,GLA3Value,IF(GLA4Name == previousLineReportingValue02,GLA4Value,IF(GLA5Name == previousLineReportingValue02,GLA5Value,IF(GLA6Name == previousLineReportingValue02,GLA6Value,IF(GLA7Name == previousLineReportingValue02,GLA7Value,subtotalGroup2ReportingValue23)))))))}" type="{!IF(subtotalGroup2ReportingValue23 == 0, TypeZero, dataRange.reportingValues['21'].Type)}" rendered="{!RenderReportingValue21}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/></span>
                            </td>
                            <td class="{!if(renderLastSubtotal && displaySubtotals && RenderReportingValue24,'ffrsubtotald','ffrsubtotalhidden')}">
                                <span class="{!if(RenderReportingValue24 && dataRange.reportingValues['24'].isSum,'ffrsubtotald','ffrsubtotalhidden')}"><ffr:Formatter value="{!subtotalGroup2ReportingValue24}" type="{!IF(subtotalGroup2ReportingValue24 == 0, TypeZero, dataRange.reportingValues['24'].Type)}" rendered="{!RenderReportingValue24}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/></span>
                            </td>
                            <td class="{!if(renderLastSubtotal && displaySubtotals && RenderReportingValue25,'ffrsubtotald','ffrsubtotalhidden')}">
                                <span class="{!if(RenderReportingValue25 && dataRange.reportingValues['25'].isSum,'ffrsubtotald','ffrsubtotalhidden')}"><ffr:Formatter value="{!subtotalGroup2ReportingValue25}" type="{!IF(subtotalGroup2ReportingValue25 == 0, TypeZero, dataRange.reportingValues['25'].Type)}" rendered="{!RenderReportingValue25}" numberPattern="{!VN}" zeroPattern="{!VZ}" datePattern="{!dateFormat}"/></span>
                            </td>
                        </tr>


    <!-- Next Row -->
                    </apex:repeat>

                </table>
            </apex:outputpanel>
        </apex:repeat>
    <!-- DETAIL DATA RANGES: END -->
    </apex:outputpanel>
<!-- REGION 06: REPORT CHATTER START -->
    <ffr:ShowChatter value="{!ReportingLog}" rendered="{!PrintChatterFeed}" printPDF="{!RenderReportAs}"/>
<!-- REGION 06: REPORT CHATTER END -->
</apex:page>